-- FACT_BILLING_VAS: Stores VAS billing facts. Grain: One row per prep line + VAS code.
CREATE TABLE SMART_BI.FACT_BILLING_VAS (
    P1CDPO VARCHAR(3) NOT NULL,
    P1CACT VARCHAR(3) NOT NULL,
    P1NANP NUMBER(2,0) NOT NULL,
    P1NPRE NUMBER(9,0) NOT NULL,
    VAS_CODE VARCHAR(7) NOT NULL,
    VERSION VARCHAR(3),
    QUANTITY_PRE NUMBER(10,0),
    QUANTITY_FIX NUMBER(10,0),
    ACTIVITY_DATE DATE,
    PREPARATION_CHILD VARCHAR(20),
    PREPARATION_MOTHER VARCHAR(20),
    SAP_ORDERID VARCHAR(10),
    VAS_CLUSTER VARCHAR(50),
    BRAND VARCHAR(3),
    OWNER VARCHAR(3),
    GRADE VARCHAR(3),
    UPDATED_TS TIMESTAMP_NTZ,
    PRIMARY KEY (P1CDPO, P1CACT, P1NANP, P1NPRE, VAS_CODE)
);
